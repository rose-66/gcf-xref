{{ config(materialized='ephemeral') }}

{% call statement('raw_site_orders_budget_vs_act', fetch_result=False) %}
CREATE OR REPLACE EXTERNAL TABLE `{{ target.project }}.slv_xref.ext_site_orders_budget_vs_act`
(
    leader STRING,
    region STRING,
    site_name STRING,
    site_name_tableau STRING,
    modality_group STRING,
    fw1_25_budget FLOAT64,
    fw1_25_actual FLOAT64,
    fw1_25_gap FLOAT64,
    fw2_25_budget FLOAT64,
    fw2_25_actual FLOAT64,
    fw2_25_gap FLOAT64,
    fw3_25_budget FLOAT64,
    fw3_25_actual FLOAT64,
    fw3_25_gap FLOAT64,
    fw4_25_budget FLOAT64,
    fw4_25_actual FLOAT64,
    fw4_25_gap FLOAT64,
    fw5_25_budget FLOAT64,
    fw5_25_actual FLOAT64,
    fw5_25_gap FLOAT64,
    fw6_25_budget FLOAT64,
    fw6_25_actual FLOAT64,
    fw6_25_gap FLOAT64,
    fw7_25_budget FLOAT64,
    fw7_25_actual FLOAT64,
    fw7_25_gap FLOAT64,
    fw8_25_budget FLOAT64,
    fw8_25_actual FLOAT64,
    fw8_25_gap FLOAT64,
    fw9_25_budget FLOAT64,
    fw9_25_actual FLOAT64,
    fw9_25_gap FLOAT64,
    fw10_25_budget FLOAT64,
    fw10_25_actual FLOAT64,
    fw10_25_gap FLOAT64,
    fw11_25_budget FLOAT64,
    fw11_25_actual FLOAT64,
    fw11_25_gap FLOAT64,
    fw12_25_budget FLOAT64,
    fw12_25_actual FLOAT64,
    fw12_25_gap FLOAT64,
    fw13_25_budget FLOAT64,
    fw13_25_actual FLOAT64,
    fw13_25_gap FLOAT64,
    fw14_25_budget FLOAT64,
    fw14_25_actual FLOAT64,
    fw14_25_gap FLOAT64,
    fw15_25_budget FLOAT64,
    fw15_25_actual FLOAT64,
    fw15_25_gap FLOAT64,
    fw16_25_budget FLOAT64,
    fw16_25_actual FLOAT64,
    fw16_25_gap FLOAT64,
    fw17_25_budget FLOAT64,
    fw17_25_actual FLOAT64,
    fw17_25_gap FLOAT64,
    fw18_25_budget FLOAT64,
    fw18_25_actual FLOAT64,
    fw18_25_gap FLOAT64,
    fw19_25_budget FLOAT64,
    fw19_25_actual FLOAT64,
    fw19_25_gap FLOAT64,
    fw20_25_budget FLOAT64,
    fw20_25_actual FLOAT64,
    fw20_25_gap FLOAT64,
    ytd_25_budget FLOAT64,
    ytd_25_actual FLOAT64,
    ytd_25_gap FLOAT64
)
OPTIONS (
    format = 'CSV',
    uris = ['gs://xref-ext-tables/fixed_vs_adg_orders/ingestion_timestamp=20251002_154232/raw_site_orders_budget_vs_act.csv'],
    skip_leading_rows = 2,
    field_delimiter = ',',
    allow_quoted_newlines = true,
    allow_jagged_rows = true
);

{% endcall %}